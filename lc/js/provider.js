!function(){var e,t=require("AppConfig","globals"),r="worker_validate_filter.js",a={isLogined:function(){var e=this.getStorageItem("login.username");return!!e},getLogin:function(){return this.getStorageItem("login.username")},saveLogin:function(e){this.setStorageItem("login.username",e)},clearLogin:function(){this.setStorageItem("login.username",null)},queryWorkList:function(a,i){var i=i||function(){},a=$.extend(!0,{department:0,workType:0},a),n=function(){var n=this.getLogin();if(!n)return i({err:t.errNotLogined});var o=this.getStorageItem("database.work")||{};if("undefined"!=typeof Worker)e||(e=new Worker(r)),e.postMessage(JSON.stringify({filter:a,origData:o})),e.onmessage=function(t){var r=JSON.parse(t.data);i(r.length?r:null),e.terminate(),e=null};else{var s=function(e,t){var r,a,i,n=[];for(var o in t)r=t[o],e.author&&r.author!==e.author||!(0!==e.department&&r.department!==e.department||0!==e.workType&&r.workType!==e.workType||e.startTime&&!(e.startTime<=r.createTime)||e.endTime&&!(e.endTime>=r.createTime)||e.keywords&&(a=new RegExp(e,"i"),i=!1,(a.test(r.author)||a.test(r.name)||a.test(r.content))&&(i=!0),!i)||!n.push(r));return n},u=s(a,o);i(u.length?u:null)}}.bind(this);setTimeout(n,t.simDelay)},getWork:function(e,r){var r=r||function(){},a=function(){var a=this.getLogin();if(!a)return r({err:t.errNotLogined});var i=this.getStorageItem("database.work")||{},n=i[e];r(n?n:{err:t.errNoSuchData})}.bind(this);setTimeout(a,t.simDelay)},createWork:function(e,r){var r=r||function(){},a=function(){var a=this.getLogin();if(!a)return r({err:t.errNotLogined});var i=this.getStorageItem("database.work")||{},n=Math.guid(),o=(new Date).valueOf(),s=$.extend(!0,{createTime:o},e,{id:n,author:a,updateTime:o});i[n]=s,this.setStorageItem("database.work",i),r(s)}.bind(this);setTimeout(a,t.simDelay)},updateWork:function(e,r){var r=r||function(){},a=function(){var a=this.getLogin();if(!a)return r({err:t.errNotLogined});var i=e?e.id:null,n=this.getStorageItem("database.work")||{},o=n[i];return o?(n[i]=$.extend(!0,o,e,{author:a,updateTime:(new Date).valueOf()}),this.setStorageItem("database.work",n),void r(o)):r({err:t.errNoSuchData})}.bind(this);setTimeout(a,t.simDelay)},deleteWork:function(e,r){var r=r||function(){},a=function(){var a=this.getLogin();if(!a)return r({err:t.errNotLogined});var i=this.getStorageItem("database.work")||{},n=i[e];return n?(i[e]=null,delete i[e],this.setStorageItem("database.work",i),void r(e)):r({err:t.errNoSuchData})}.bind(this);setTimeout(a,t.simDelay)},queryMessageList:function(e){var e=e||function(){},r=function(){var t=this.getStorageItem("database.message","session")||{},r=[];for(var a in t)r.push(t[a]);e(r)}.bind(this);setTimeout(r,t.simDelay)},createMessage:function(e,r){var r=r||function(){},a=function(){var t=this.getStorageItem("database.message","session")||{},a=(new Date).valueOf(),i=Math.guid(),n={id:i,msg:e,createTime:a,updateTime:a};t[i]=n,this.setStorageItem("database.message",t,"session"),r(n)}.bind(this);setTimeout(a,t.simDelay)},postal:$({}),publish:function(e,t){this.postal.trigger("react-admin-ctrl."+e,t)},subscribe:function(e,t){this.postal.on("react-admin-ctrl."+e,t)},unsubscribe:function(e,t){this.postal.off("react-admin-ctrl."+e,t)},setStorageItem:function(e,t,r){var a;a="object"==typeof t&&null!==t?{stringify:!0,realValue:JSON.stringify(t)}:{stringify:!1,realValue:t},"session"!==r?localStorage.setItem("react-admin-ctrl."+e,JSON.stringify(a)):sessionStorage.setItem("react-admin-ctrl."+e,JSON.stringify(a))},getStorageItem:function(e,t){var r;if(r="session"!==t?localStorage.getItem("react-admin-ctrl."+e):sessionStorage.getItem("react-admin-ctrl."+e),!r)return r;var a,i=JSON.parse(r);return a=i.stringify?JSON.parse(i.realValue):i.realValue}};window.__Globals__.AppProvider=a}();